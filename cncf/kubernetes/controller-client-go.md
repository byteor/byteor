# Controller client-go

~~~
+------------------------------------------------------------------------------------------------------+
| client-go                                                 +------------------------+                 |
|                                                           | Kubernetes API         |                 |
|                 +-----------+      1) List & Watch        |                        |                 |
|                 | Reflector |---------------------------->| Kubernetes server-side |                 |
|                 +-----------+                             +------------------------+                 |
|                       |                                                                              |
|         2) Add Object |                                                                              |
|                       v                                                                              |
|                    +------+                                                                          |
|                    |------| Delta FIFO                                                               |
|                    |------| Queue                                                                    |
|                    |------|                                                                          |
|                    +------+                                                                          |
|                       |                                                                              |
|         3) Pop Object |                                                        +----------------+    |
|                       v                                                        | /+-----------+ |    |
|                  +----------+  4) Add Object  +---------+ 5) Store Object Key  |/ |#|#| | | | | |    |
|                  | Informer |---------------->| Indexer |--------------------->|\ +-----------+ |    |
|                  +----------+                 +---------+                      | \              |    |
|   Event Handlers      | .                          .                           |  +-----------+ |    |
|       +-----+         | .                          .                           |  |$| | | | | | |    |
|       |/////|<--------+ .                          .                           |  +-----------+ |    |
|       +-----+  6) Dispatch Event Handler Funcs     .                           |ThreadSafe Store|    |
|          .              .                          .                           +----------------+    |
|          .              .                          .                                                 |
+----------.--------------.--------------------------.-------------------------------------------------+
|          .              .                          .                                                 |
|          .              .                          .                                                 |
|     +--------+      +------+                   +------+                                              |
|     |Resource|      |//////|                   |//////|<-----------+                                 |
|     |  Event |      +------+                   +------+            |                                 |
|     |Handlers|      Informer                   Indexer             | 9) Get Object for Key           |
|     +--------+      Reference                  Reference           |                                 |
| 7)Enqueue|                                                         |                                 |
|   Object |                                                         |                                 |
|   Key    |     +---------+ 8) Get key +------------+           +--------+                            |
|          +---->|#| | | | |----------->|Process Item|---------->| Handle |                            |
|                +---------+            +------------+           | Object |                            |
|                 Workqueue                                      +--------+                            |
|                                                                                                      |
|Controller                                                                                            |
+------------------------------------------------------------------------------------------------------+
~~~
