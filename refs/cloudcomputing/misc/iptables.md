# the flow of packets through the chains in various tables


```text
+---------+                         PREROUTING                                                   INPUT                +---------+
|         |     +--------------------------------------------------+                +----------------------------+    |         |
|         |     |   +-----+   +----------+   +--------+   +-----+  |                |   +--------+   +--------+  |    |         |
|         |-----|-->| raw |-->|connection|-->| mangle |-->| nat |--|----------------|-->| mangle |-->| filter |--|--->|         |
|         |     |   +-----+   | tracking |   +--------+   +-----+  |                |   +--------+   +--------+  |    |         |
|         |     |             +----------+                   |     |                +----------------------------+    |         |
|         |     +--------------------------------------------------+                                                  |         |
|         |                                                  |                                                        |         |
| Network |                                                  |                                                        |  Local  |
|interface|                                             +----------+                                                  | Process |
|         |                                             |    v     |                                                  |         |
|         |                                             | +------+ |                                                  |         |
|         |                                             | |mangle| | FORWARD                                          |         |
|         |                                             | +------+ |                                                  |         |
|         |                                             |    |     |                                                  |         |
|         |                                             |    v     |                                                  |         |
|         |                                             | +------+ |                                                  |         |
|         |                                +------------|-|filter| |                                                  |         |
|         |                                |            | +------+ |                                                  |         |
|         |                                |            +----------+                                                  |         |
|         |                                v                                                                          |         |
|         |                +---------------------------+    +------------------------------------------------------+  |         |
|         |                | +-----+   +--------+      |    | +------+   +-----+   +------+   +----------+   +---+ |  |         |
|         |                | | nat |<--| mangle |      |<---| |filter|<--| nat |<--|mangle|<--|connection|<--|raw| |--|         |
|         |                | +-----+   +--------+      |    | +------+   +-----+   +------+   | tracking |   +---+ |  |         |
|         |                +---------------------------+    +------------------------------------------------------+  |         |
|         |                         POSTROUTING                                      OUTPUT                           |         |
+---------+                                                                                                           +---------+
```
