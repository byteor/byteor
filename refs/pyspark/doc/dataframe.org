#+TITLE: Pyspark DataFrame
#+AUTHOR: Zhou Peng
#+EMAIL: p@ctriple.cn

* dataframe 3 advanced operations

** faked programming language datum

| language   | born |   user | trend  | learned |
|------------+------+--------+--------+---------|
| c          | 1970 | 400000 | stable | ****    |
| java       | 1995 | 500000 | down   | **      |
| go         | 2007 | 200000 | up     | ****    |
| javascript | 1995 | 700000 | up     | **      |
| lisp       | 1960 | 300000 | stable | ****    |
| asm        | 1960 | 100000 | down   | **      |
| python     | 1995 | 350000 | up     | ***     |

** group by [trend] then sum [user]

| language   | born |   user | trend  | learned |
|------------+------+--------+--------+---------|
| asm        | 1960 | 100000 | down   | **      |
| java       | 1995 | 500000 | down   | **      |
| lisp       | 1960 | 300000 | stable | ****    |
| c          | 1970 | 400000 | stable | ****    |
| javascript | 1995 | 700000 | up     | **      |
| python     | 1995 | 350000 | up     | ***     |
| go         | 2007 | 200000 | up     | ****    |

| trend  | sum(user) |
|--------+-----------|
| down   |    600000 |
| stable |    700000 |
| up     |   1250000 |

** group by [born] then collect [language]

| language   | born |   user | trend  | learned |
|------------+------+--------+--------+---------|
| lisp       | 1960 | 300000 | stable | ****    |
| asm        | 1960 | 100000 | down   | **      |
| c          | 1970 | 400000 | stable | ****    |
| java       | 1995 | 500000 | down   | **      |
| javascript | 1995 | 700000 | up     | **      |
| python     | 1995 | 350000 | up     | ***     |
| go         | 2007 | 200000 | up     | ****    |

| born | language                   |
|------+----------------------------|
| 1960 | [lisp, asm]                |
| 1970 | [c]                        |
| 1995 | [java, javascript, python] |
| 2007 | [go]                       |

** group by [trend] and pivot [born] then count [language]

| language   | born |   user | trend  | learned |
|------------+------+--------+--------+---------|
| asm        | 1960 | 100000 | down   | **      |
| java       | 1995 | 500000 | down   | **      |
| lisp       | 1960 | 300000 | stable | ****    |
| c          | 1970 | 400000 | stable | ****    |
| javascript | 1995 | 700000 | up     | **      |
| python     | 1995 | 350000 | up     | ***     |
| go         | 2007 | 200000 | up     | ****    |

| trend  | born | count(language) |
|--------+------+-----------------|
| down   | 1960 |               1 |
| down   | 1970 |               0 |
| down   | 1995 |               2 |
| down   | 2007 |               0 |
| stable | 1960 |               1 |
| stable | 1970 |               1 |
| stable | 1995 |               0 |
| stable | 2007 |               0 |
| up     | 1960 |               0 |
| up     | 1970 |               0 |
| up     | 1995 |               2 |
| up     | 2007 |               1 |
